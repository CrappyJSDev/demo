"use strict";angular.module("diguSignApp",["ngCookies","ngResource","ngSanitize","ngAnimate","ngAria","ngMaterial","data-table","ui.router","pdfjsViewer"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","$compileProvider",function(a,b,c,d,e){b.otherwise("/"),c.html5Mode(!0),d.interceptors.push("authInterceptor"),e.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension|bitid):/)}]).factory("authInterceptor",["$rootScope","$q","$cookieStore","$location",function(a,b,c,d){return{request:function(a){return a.headers=a.headers||{},c.get("token")&&(a.headers.Authorization="Bearer "+c.get("token")),a},responseError:function(a){return 401===a.status?(d.path("/"),c.remove("token"),b.reject(a)):b.reject(a)}}}]).run(["$rootScope","$location","Auth",function(a,b,c){a.$on("$stateChangeStart",function(a,d){c.isLoggedInAsync(function(c){d.authenticate&&!c&&(a.preventDefault(),b.path("/"))})})}]),angular.module("diguSignApp").controller("MainCtrl",["$scope","$http","Auth","User","$mdDialog",function(a,b,c,d,e){a.user=c.getCurrentUser,a.isLoggedIn=c.isLoggedIn,a.totalPlayers=0,a.timers=[5,10,15,20,25,30,60],a.serverOptions={rowHeight:50,headerHeight:50,footerHeight:!1,scrollbarV:!1,columns:[{name:"Server Name",prop:"name",width:300,sort:"desc"},{name:"Current Players",prop:"players"}]},a.pugOptions={rowHeight:50,footerHeight:!1,scrollbarV:!1,columns:[{name:"Players",prop:"player"}]},a.showAlert=function(a){e.show(e.alert().parent(angular.element(document.body)).clickOutsideToClose(!0).title("Success").textContent("You have successfully changed this setting.").ariaLabel("Settting Changed").ok("Okay!").targetEvent(a))},a.setTimer=function(b){c.changeTimer(b).then(function(){a.showAlert()})["catch"](function(a){console.log(a)})},a.activePage="Server Status",a.changePage=function(b){var c=[],d=[];a.activePage=b,"LCTF"===b?(c=a.pugs[1].players,a.pugs[1].games[0]&&(d=a.pugs[1].games[0].users)):"Base"===b?(c=a.pugs[0].players,a.pugs[0].games[0]&&(d=a.pugs[0].games[0].users)):"LCTFEU"===b&&(a.pugs[2].games[0]&&(d=a.pugs[2].games[0].users),c=a.pugs[2].players),a.row=c.map(function(a){return{player:a}}),d?a.gamesRow=d.map(function(a){return{player:a}}):a.gamesRow=[]},a.run=function(){return b.get("/api/stats").success(function(b){return a.selectedItem=b.pugs[0],a.servers=b.servers,a.pugs=b.pugs,b.servers.map(function(b){return a.totalPlayers+=b.players})}).then(function(){a.notify={Server:{name:a.servers[0].name,players:0},LCTF:{name:"LCTF",players:Number(a.user().notifyArray.LCTF)||0},Base:{name:"Base",players:Number(a.user().notifyArray.Base)||0},LCTFEU:{name:"LCTFEU",players:Number(a.user().notifyArray.LCTFEU)||0},timer:a.user().notificationTimer||25}})["catch"](function(a){console.log(a)})},a.run(),a.update=function(b,d){c.changeAccount(b,d).then(function(){a.showAlert()})["catch"](function(a){console.log(a)})}}]),angular.module("diguSignApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"})}]),angular.module("diguSignApp").factory("apiService",["$location","$rootScope","$http","User","$cookieStore","$q",function(a,b,c,d,e,f){var g={};return g.createDoc=function(a){var b=f.defer();return c.post("/api/documents/",a).success(function(a){b.resolve(a)})["catch"](function(a){b.reject(a)}),b.promise},g.findDoc=function(a){var b=f.defer();return c.get("/api/documents/find/"+a).success(function(a){b.resolve(a)})["catch"](function(a){b.reject(a)}),b.promise},g.checkOpReturn=function(a){var b=f.defer(),d=null;return c.get("https://digiexplorer.info/api/tx/"+a).success(function(a){console.log(a);for(var c in a.vout)a.vout[c].scriptPubKey.asm.indexOf("OP_RETURN")>-1&&(d=a.vout[c].scriptPubKey.hex);for(var e=d.toString(),f="",c=0;c<e.length;c+=2)f+=String.fromCharCode(parseInt(e.substr(c,2),16));return f?b.resolve(f.substring(2)):void b.reject()})["catch"](function(a){b.reject(a)}),b.promise},g}]),angular.module("diguSignApp").factory("Auth",["$location","$rootScope","$http","User","$cookieStore","$q",function(a,b,c,d,e,f){var g={};return e.get("token")&&(g=d.get()),{login:function(a,b){var h=b||angular.noop,i=f.defer();return c.post("/auth/local",{email:a.email,password:a.password}).success(function(a){return e.put("token",a.token),g=d.get(),i.resolve(a),h()}).error(function(a){return this.logout(),i.reject(a),h(a)}.bind(this)),i.promise},loginbitId:function(a){e.put("token",a),g=d.get()},manualLogin:function(a){var b=f.defer();return c.post("/auth/bitid/callback",a).success(function(a){console.log(a),b.resolve()})["catch"](function(a){b.reject(a)}),b.promise},logout:function(){e.remove("token"),g={}},createUser:function(a,b){var c=b||angular.noop;return d.save(a,function(b){return e.put("token",b.token),g=d.get(),c(a)},function(a){return this.logout(),c(a)}.bind(this)).$promise},changePassword:function(a,b,c){var e=c||angular.noop;return d.changePassword({id:g._id},{oldPassword:a,newPassword:b},function(a){return e(a)},function(a){return e(a)}).$promise},changeAccount:function(a,b,c){var e=c||angular.noop;return d.changeAccount({id:g._id},{name:a,count:b},function(a){return e(a)},function(a){return e(a)}).$promise},changeTimer:function(a,b){var c=b||angular.noop;return d.changeTimer({id:g._id},{timer:a},function(a){return c(a)},function(a){return c(a)}).$promise},getCurrentUser:function(){return g},isLoggedIn:function(){return g.hasOwnProperty("role")},isLoggedInAsync:function(a){g.hasOwnProperty("$promise")?g.$promise.then(function(){a(!0)})["catch"](function(){a(!1)}):a(g.hasOwnProperty("role")?!0:!1)},isAdmin:function(){return"admin"===g.role},getToken:function(){return console.log(e.get("token")),e.get("token")}}}]),angular.module("diguSignApp").factory("User",["$resource",function(a){return a("/api/users/:id/:controller",{id:"@_id"},{changePassword:{method:"PUT",params:{controller:"password"}},changeAccount:{method:"POST",params:{controller:"account"}},changeTimer:{method:"POST",params:{controller:"timer"}},get:{method:"GET",params:{id:"me"}}})}]),angular.module("diguSignApp").directive("mongooseError",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){return d.$setValidity("mongoose",!0)})}}}),angular.module("diguSignApp").controller("NavbarCtrl",["$scope","$location","$window","Auth",function(a,b,c,d){a.menu=[{title:"Home",link:"/"}],a.isCollapsed=!0,a.isLoggedIn=d.isLoggedIn,a.isAdmin=d.isAdmin,a.getCurrentUser=d.getCurrentUser,a.logout=function(){d.logout(),b.path("/login")},a.isActive=function(a){return a===b.path()},a.loginOauth=function(a){c.location.href="/auth/"+a}}]),angular.module("diguSignApp").run(["$templateCache",function(a){a.put("app/main/main.html",'<div id=content class=container role=main style=top:100px><div class=row style="height: 760px"><div class=text-center ng-hide="!user.friended && isLoggedIn"><h3>You are not friends with the bot, please request a friend invite</h3><button class="btn btn-info">Request</button></div><div class="col-lg-8 col-lg-offset-2"><div class="row outer-content"><div class="col-xs-2 inner-menu text-left"><h4 class=text-left style="text-decoration: underline; font-weight: bold">Game Status</h4><li><a href="" ng-click="changePage(\'Server Status\')">Servers [{{totalPlayers}}]</a></li><li><a href="" ng-click="changePage(\'LCTF\')">LCTF [{{pugs[1].current_players}}/{{pugs[1].max_players}}]</a></li><li><a href="" ng-click="changePage(\'Base\')">Base [{{pugs[0].current_players}}/{{pugs[0].max_players}}]</a></li><li><a href="" ng-click="changePage(\'LCTFEU\')">LCTFEU [{{pugs[2].current_players}}/{{pugs[2].max_players}}]</a></li><div id=loggedIn ng-show=user().friended><h4 style="text-decoration: underline; font-weight: bold; padding-top:10px">My Account</h4><li><a href=# ng-click="changePage(\'Settings\')">Settings</a></li></div><div id=loggedIn ng-show=user().friended><h4 style="text-decoration: underline; font-weight: bold; padding-top:10px">Notifications</h4><li><a href=# ng-click="changePage(\'Notifications Servers\')">Server</a></li><li><a href=# ng-click="changePage(\'Notifications LCTF\')">LCTF</a></li><li><a href=# ng-click="changePage(\'Notifications Base\')">Base</a></li><li><a href=# ng-click="changePage(\'Notifications LCTFEU\')">LCTFEU</a></li></div></div><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Server Status\'"><h3>{{activePage}}</h3><md-content class=md-padding><div class=table-responsive><dtable options=serverOptions rows=servers class=material></dtable></div></md-content></div><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'LCTF\'"><h3>{{activePage}}</h3><md-tabs md-dynamic-height md-border-bottom><md-tab label="In Queue"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=row class="material dt"></dtable></div></md-content></md-tab><md-tab label="In Game"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=gamesRow class=material></dtable></div></md-content></md-tab></md-tabs></div><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Base\'"><h3>{{activePage}}</h3><md-tabs md-dynamic-height md-border-bottom><md-tab label="In Queue"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=row class=material></dtable></div></md-content></md-tab><md-tab label="In Game"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=gamesRow class=material></dtable></div></md-content></md-tab></md-tabs></div><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'LCTFEU\'"><h3>{{activePage}}</h3><md-tabs md-dynamic-height md-border-bottom><md-tab label="In Queue"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=row class=material></dtable></div></md-content></md-tab><md-tab label="In Game"><md-content class=md-padding><div class=table-responsive><dtable options=pugOptions rows=gamesRow class=material></dtable></div></md-content></md-tab></md-tabs></div><!-- Settings --><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Settings\'"><h3>{{activePage}}</h3><md-content class=md-padding style="height: 300px"><form name=myForm ng-submit=setTimer(notify.timer)><div layout=row layout-align="space-between center"><span>Notification Timer (in minutes)</span><md-select aria-label=notifyTimer ng-model=notify.timer><md-option ng-repeat="time in timers" value={{time}}>{{time}}</md-option></md-select></div><md-button ng-click=setTimer(notify.timer) class="md-raised md-primary submit-button">Submit</md-button></form></md-content></div><!-- Notify Servers--><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Notifications Servers\'"><h3>{{activePage}}</h3><md-content class=md-padding style="min-height: 380px"><form name=myForm ng-submit="update(notify.Server.name, notify.Server.players)"><div class=form-group><label name=name for=name>Server</label><select ng-model=notify.Server.name class=form-control><option ng-repeat="option in servers">{{option.name}}</option></select></div><div class=form-group><label for=notify.Server.players>Player Count</label><input ng-model=notify.Server.players class=form-control type=number placeholder="1"></div><md-button class="md-raised md-primary submit-button">Submit</md-button></form></md-content></div><!-- Notify LCTF--><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Notifications LCTF\'"><h3>{{activePage}}</h3><md-content class=md-padding style="min-height: 380px"><form ng-submit="update(notify.LCTF.name, notify.LCTF.players)"><div class=form-group><label for=notify.LCTF.players>Player Count</label><input class=form-control ng-model=notify.LCTF.players type=number placeholder="1"></div><md-button class="md-raised md-primary submit-button">Submit</md-button></form></md-content><div class=col-lg-12 style="margin-top: 350px; font-weight: bold"><span class=text-center>Recieve a message via steam when a this pug reaches a set number of players</span></div></div><!-- Notify Base--><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Notifications Base\'"><h3>{{activePage}}</h3><md-content class=md-padding style="min-height: 380px"><form ng-submit="update(notify.Base.name, notify.Base.players)"><div class=form-group><label for=notify.Base.players>Player Count</label><input class=form-control ng-model=notify.Base.players type=number placeholder="1"></div><md-button class="md-raised md-primary submit-button">Submit</md-button></form></md-content><div class=col-lg-12 style="margin-top: 350px; font-weight: bold"><span class=text-center>Recieve a message via steam when a this pug reaches a set number of players</span></div></div><!-- Notify LCTFEU--><div class="col-xs-8 col-xs-offset-1 text-center" style=padding:10px ng-show="activePage === \'Notifications LCTFEU\'"><h3>{{activePage}}</h3><md-content class=md-padding style="min-height: 380px"><form ng-submit="update(notify.LCTFEU.name, notify.LCTFEU.players)"><div class=form-group><label for=notify.LCTFEU.players>Player Count</label><input class=form-control ng-model=notify.LCTFEU.players type=number placeholder="1"></div><md-button class="md-raised md-primary submit-button">Submit</md-button></form></md-content><div class=col-lg-12 style="margin-top: 350px; font-weight: bold"><span class=text-center>Recieve a message via steam when a this pug reaches a set number of players</span></div></div></div></div></div></div>'),a.put("components/footer/footer.html",'<!-- BEGIN: BACK-TO-TOP BUTTON --><div id=back-to-top><a href=javascript:;></a></div><!-- BEGIN: SECONDARY FOOTER --><div class=copys><div class=container><!-- BEGIN: SECONDARY FOOTER LEFT --><div class="copys_left eight columns">© 2016 Copyrights PeTtY | All rights Reserved<br><!-- BEGIN: FOOTER MENU --><a href="/">Home</a> - <a target=_blank href="https://forums.playmidair.com/members/petty.506/">Contact</a></div></div></div><!-- END: SECONDARY FOOTER -->'),a.put("components/navbar/navbar.html",'<div class="header_container headerstyle-style1" ng-controller=NavbarCtrl style="background-color: #F7F7F7; height: 50px"><!-- BEGIN: TOP BAR --><div class="fullwidth_container style-top-bar"><div class=container><div class=info_above_menu><!-- BEGIN: TOP BAR CONTENTS LEFT --><div class="eight columns" style="float:left;top: 13px; position:relative"><div class=username ng-show=isLoggedIn()><img ng-src="{{getCurrentUser().steam.avatar}}"> <span style="position: relative; bottom: 4px"><strong>Welcome:</strong> {{getCurrentUser().steam.personaname}}</span></div><div class=username ng-hide=isLoggedIn()><span><strong>Welcome, Please sign in!</strong></span></div></div><!-- END --><!-- BEGIN: TOP BAR CONTENTS RIGHT --><div class="eight columns"><div style="float:right; padding:2px" ng-show=!isLoggedIn()><a href="" ng-click="loginOauth(\'steam\')" style="position: relative; bottom:12px"><img src="https://steamcommunity-a.akamaihd.net/public/images/signinthroughsteam/sits_01.png"></a></div></div><!-- END --></div></div></div><!-- END: TOP BAR --></div>')}]);